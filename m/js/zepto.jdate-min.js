function Swipe(b,d){function u(){e=c.children;C=e.length;2>e.length&&(d.continuous=!1);h.transitions&&d.continuous&&3>e.length&&(c.appendChild(e[0].cloneNode(!0)),c.appendChild(c.children[1].cloneNode(!0)),e=c.children);p=Array(e.length);f=b.getBoundingClientRect().width||b.offsetWidth;c.style.width=e.length*f+"px";for(var k=e.length;k--;){var g=e[k];g.style.width=f+"px";g.setAttribute("data-index",k);h.transitions&&(g.style.left=k*-f+"px",m(k,a>k?-f:a<k?f:0,0))}d.continuous&&h.transitions&&(m(l(a-
1),-f,0),m(l(a+1),f,0));h.transitions||(c.style.left=a*-f+"px");b.style.visibility="visible"}function x(){d.continuous?z(a+1):a<e.length-1&&z(a+1)}function l(k){return(e.length+k%e.length)%e.length}function z(k,c){if(a!=k){if(h.transitions){var b=Math.abs(a-k)/(a-k);if(d.continuous){var n=b,b=-p[l(k)]/f;b!==n&&(k=-b*e.length+k)}for(n=Math.abs(a-k)-1;n--;)m(l((k>a?k:a)-n-1),f*b,0);k=l(k);m(a,f*b,c||s);m(k,0,c||s);d.continuous&&m(l(k-b),-(f*b),0)}else k=l(k),r(a*-f,k*-f,c||s);a=k;b=d.callback&&d.callback(a,
    e[a]);setTimeout(b||g,0)}}function m(k,a,c){v(k,a,c);p[k]=a}function v(a,c,b){if(a=(a=e[a])&&a.style)a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=b+"ms",a.webkitTransform="translate("+c+"px,0)translateZ(0)",a.msTransform=a.MozTransform=a.OTransform="translateX("+c+"px)"}function r(k,b,g){if(g)var h=+new Date,f=setInterval(function(){var p=+new Date-h;p>g?(c.style.left=b+"px",y&&(w=setTimeout(x,y)),d.transitionEnd&&d.transitionEnd.call(event,
    a,e[a]),clearInterval(f)):c.style.left=Math.floor(p/g*100)/100*(b-k)+k+"px"},4);else c.style.left=b+"px"}function n(){y=0;clearTimeout(w)}var g=function(){},h={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(a){var c=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"],b;for(b in c)if(void 0!==a.style[c[b]])return!0;return!1}(document.createElement("swipe"))};if(b){var c=
    b.children[0],e,p,f,C;d=d||{};var a=parseInt(d.startSlide,10)||0,s=d.speed||300;d.continuous=void 0!==d.continuous?d.continuous:!0;var y=d.auto||0,w,D,E,F,q,B,A,t={handleEvent:function(a){switch(a.type){case "touchstart":this.start(a);break;case "touchmove":this.move(a);break;case "touchend":var c=this.end(a);setTimeout(c||g,0);break;case "webkitTransitionEnd":case "msTransitionEnd":case "oTransitionEnd":case "otransitionend":case "transitionend":c=this.transitionEnd(a);setTimeout(c||g,0);break;case "resize":setTimeout(u||
g,0)}d.stopPropagation&&a.stopPropagation()},start:function(a){a=a.touches[0];D=a.pageX;E=a.pageY;F=+new Date;B=q=A=void 0;c.addEventListener("touchmove",this,!1);c.addEventListener("touchend",this,!1)},move:function(c){if(!(1<c.touches.length||c.scale&&1!==c.scale)){d.disableScroll&&c.preventDefault();var b=c.touches[0];q=b.pageX-D;B=b.pageY-E;"undefined"==typeof A&&(A=!!(A||Math.abs(q)<Math.abs(B)));A||(c.preventDefault(),n(),d.continuous?(v(l(a-1),q+p[l(a-1)],0),v(a,q+p[a],0),v(l(a+1),q+p[l(a+
1)],0)):(q/=!a&&0<q||a==e.length-1&&0>q?Math.abs(q)/f+1:1,v(a-1,q+p[a-1],0),v(a,q+p[a],0),v(a+1,q+p[a+1],0)))}},end:function(b){b=250>Number(+new Date-F)&&20<Math.abs(q)||Math.abs(q)>f/2;var g=!a&&0<q||a==e.length-1&&0>q;d.continuous&&(g=!1);var h=0>q;A||(b&&!g?(h?(d.continuous?(m(l(a-1),-f,0),m(l(a+2),f,0)):m(a-1,-f,0),m(a,p[a]-f,s),m(l(a+1),p[l(a+1)]-f,s),a=l(a+1)):(d.continuous?(m(l(a+1),f,0),m(l(a-2),-f,0)):m(a+1,f,0),m(a,p[a]+f,s),m(l(a-1),p[l(a-1)]+f,s),a=l(a-1)),d.callback&&d.callback(a,e[a])):
    d.continuous?(m(l(a-1),-f,s),m(a,0,s),m(l(a+1),f,s)):(m(a-1,-f,s),m(a,0,s),m(a+1,f,s)));c.removeEventListener("touchmove",t,!1);c.removeEventListener("touchend",t,!1)},transitionEnd:function(c){parseInt(c.target.getAttribute("data-index"),10)==a&&(y&&(w=setTimeout(x,y)),d.transitionEnd&&d.transitionEnd.call(c,a,e[a]))}};u();y&&(w=setTimeout(x,y));h.addEventListener?(h.touch&&c.addEventListener("touchstart",t,!1),h.transitions&&(c.addEventListener("webkitTransitionEnd",t,!1),c.addEventListener("msTransitionEnd",
    t,!1),c.addEventListener("oTransitionEnd",t,!1),c.addEventListener("otransitionend",t,!1),c.addEventListener("transitionend",t,!1)),window.addEventListener("resize",t,!1)):window.onresize=function(){u()};return{setup:function(){u()},slide:function(a,c){n();z(a,c)},prev:function(){n();d.continuous?z(a-1):a&&z(a-1)},next:function(){n();x()},stop:function(){n()},getPos:function(){return a},getNumSlides:function(){return C},kill:function(){n();c.style.width="";c.style.left="";for(var a=e.length;a--;){var b=
    e[a];b.style.width="";b.style.left="";h.transitions&&v(a,0,0)}h.addEventListener?(c.removeEventListener("touchstart",t,!1),c.removeEventListener("webkitTransitionEnd",t,!1),c.removeEventListener("msTransitionEnd",t,!1),c.removeEventListener("oTransitionEnd",t,!1),c.removeEventListener("otransitionend",t,!1),c.removeEventListener("transitionend",t,!1),window.removeEventListener("resize",t,!1)):window.onresize=null}}}}
(window.jQuery||window.Zepto)&&function(b){b.fn.Swipe=function(d){return this.each(function(){b(this).data("Swipe",new Swipe(b(this)[0],d))})}}(window.jQuery||window.Zepto);
(function(b,d,u){function x(){this.tablePanels=this.swipe=null}function l(b,h){if(b&&h){if(2==h)return 0==b%4&&0!=b%100||0==b%400?29:28;var c=[1,3,5,7,8,10,12],e=[4,6,9,11],p;for(p in c)if(c[p]==h)return 31;for(p in e)if(e[p]==h)return 30}}function z(g,h){if(g&&h){for(var c=(new Date(g,h-1,1)).getDay(),e=l(g,h),p=Math.floor((e+c)/7),p=0==(e+c)%7?p:p+1,f=1,d=b('<ul class="jdate-table table"></ul>'),a=1;a<=p;a++){for(var m=b('<li class="row"></li>'),y=1;7>=y;y++)if(1==a&&y<=c||f>e)m.append('<span class="col"></span>');
else{var w="col jdate-col ",v="",u='data-year="'+g+'" data-month="'+h+'" data-date="'+f+'"';r.date==f&&r.month==h&&r.year==g?(w+="col-today ",v="\u4eca\u5929"):v=f;n.year==g&&n.month==h&&n.date==f&&(w+="selected ");m.append('<span class="'+w+'" '+u+">"+v+"</span>");f++}d.append(m)}d.find(".jdate-col").tap(function(){var a=b(this);b("#jdate-container .jdate-col").removeClass("selected");a.toggleClass("selected");n.year=a.data("year");n.month=a.data("month");n.date=a.data("date");setTimeout(function(){b("#jdate-btn-check").trigger("click")},
    300)});return d}}function m(g){n={year:r.year,month:r.month,date:r.date};g.fadeOut(300,function(){b(this).remove()});b("#jdate-overlay").fadeOut(300)}function v(g){g.fadeIn(300);g=b("#jdate-overlay");1>g.length&&b("body").append('<div id="jdate-overlay"></div>');g.fadeIn(300)}u=new Date;var r={year:u.getFullYear(),month:u.getMonth()+1,date:u.getDate()},n={year:r.year,month:r.month,date:r.date};x.prototype.init=function(g,h,c){var e=b("#jdate")||null;if(1>e.length){var e=b('<section id="jdate"></section>'),
    d=b('<header id="jdate-header"></header>'),f=b('<i class="icon icon-check ftsize20" id="jdate-btn-check"></i>'),l=b('<i class="icon icon-remove" id="jdate-btn-remove"></i>'),a=b('<section class="jdate-header-info"></section>'),s=b('<i class="icon-arrowleft" id="jdate-btn-prev"></i>'),r=b('<i class="icon-arrowright" id="jdate-btn-next"></i>'),w=b("<span></span>"),u=b('<section class="jdate-week table"></section>'),x=b('<div class="swipe" id="slider"></div>'),z=b('<ul class="swipe-wrap" id="jdate-container"></ul>'),
    q=this;s.tap(function(){q.swipe.prev()});r.tap(function(){q.swipe.next()});l.click(function(){m(e)});f.click(function(){g.val(n.year+"-"+n.month+"-"+n.date).trigger("change");m(e)});w.text(h+"\u5e74"+c+"\u6708");a.append(s,r,w);d.append(f,l,a);u.append('<span class="col">\u65e5</span>','<span class="col">\u4e00</span>','<span class="col">\u4e8c</span>','<span class="col">\u4e09</span>','<span class="col">\u56db</span>','<span class="col">\u4e94</span>','<span class="col">\u516d</span>');this.tablePanels=
    f=[b('<li data-year="" data-month=""></li>'),b('<li data-year="" data-month=""></li>'),b('<li data-year="" data-month=""></li>')];for(l=0;l<f.length;l++)z.append(f[l]);x.append(z);e.append(d,u,x);b("body").append(e);this.createSwipe()}this.updateTable(0,h,c);this.updateTable(1,h,c+1);this.updateTable(2,h,c-1);v(e)};x.prototype.createSwipe=function(){var g=this;this.swipe=new Swipe(d.getElementById("slider"),{startSlide:0,speed:400,auto:!1,continuous:!0,disableScroll:!1,stopPropagation:!1,transitionEnd:function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        c){},callback:function(h,c){var e=b(c),d=e.data("year"),e=e.data("month");b("#jdate-header .jdate-header-info>span").text(d+"\u5e74"+e+"\u6708");switch(h){case 0:g.updateTable(1,d,e+1);g.updateTable(2,d,e-1);break;case 1:g.updateTable(0,d,e-1);g.updateTable(2,d,e+1);break;case 2:g.updateTable(1,d,e-1),g.updateTable(0,d,e+1)}}})};x.prototype.updateTable=function(b,d,c){b=this.tablePanels[b];12<c?(d+=1,c=1):1>c&&(d-=1,c=12);b.data("month",c);b.data("year",d);b.empty().append(z(d,c))};b.fn.jdate=function(){return b(this).each(function(){var d=
    b(this);d.click(function(){var b=""==d.val()?null:d.val().replace(/-/g,"/"),c=new x;b?(b=new Date(b),n.year=b.getFullYear(),n.month=b.getMonth()+1,n.date=b.getDate(),c.init(d,n.year,n.month)):c.init(d,r.year,r.month,r.date);d.blur()})})}})(Zepto,document,window);