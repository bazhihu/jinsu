<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>选择被护理人</title>
    <meta name="viewport" content="width=device-width,maximum-scale=1,minimum-scale=1" />
    <meta content="telephone=no" name="format-detection" />
    <link href="../css/style.css" rel="stylesheet" />
</head>
<body id="page-patient-list">

<header id="header">
    <a class="back">返回</a>
    <h2 class="title">被护理人</h2>
    <a class="add" href="/addPatient.html">添加</a>
</header>

<form>
    <ul class="patient-list" id="content">
    </ul>
    <script id="patient" type="text/html">
        {{each list as value i}}
        <li class="menuitem menuitemradio" role="menuitemradio">
            <label for="patient-{{value.id}}">
                <em class="name" style='margin-left:15px'>{{value.name}}</em>
                <i class="about" style='margin-left:15px'>更新时间：{{value.create_time}}</i>
                <input type="radio" name="patient" title="{{value.name}}" value="{{value.val}}" id="patient-{{value.id}}" />
            </label>
        </li>
        {{/each}}
    </script>
</form>
<div id="foot"></div>
<script src="../js/zepto-with-touch.min.js"></script>
<script src="../js/template.js" type="text/javascript"></script>
<script type='text/javascript' src='../js/public.js'></script>
<script type="text/javascript" src="../js/patient.js?v=1.8"></script>
<script>
    function setValueByHash(value) {
        value && [].forEach.call(document.getElementsByName('patient'), function (radio) {
            $(radio).parent().parent()[(radio.checked = value == radio.value) ? 'addClass' : 'removeClass']('menuitemradio-checked');
        });
    }
    $('#header .back').click(function (e) {
        var value, text;
        [].forEach.call(document.getElementsByName('patient'), function (radio) {
            if (radio.checked) {
                value = radio.value;
                text = radio.title;

            }
        });
        try {
            window.parent.$.dismissPopup({ value: value, text: text });
        } catch (error) {
            window.history.back(1);
        }
    });
    $('.menuitemradio input[type="radio"]').live('click', function () {
        [].forEach.call(this.form.elements[this.name], function (radio) {
            $(radio).parent().parent()[radio === this ? 'addClass' : 'removeClass']('menuitemradio-checked');
        }, this);

        // 当选择时，直接返回。
        $('#header .back').trigger('click');
    });
</script>
</body>
</html>
